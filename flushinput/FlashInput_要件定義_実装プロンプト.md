# FlashInput — 要件定義＋実装プロンプト

> **このドキュメントの使い方**: 下部の「実装プロンプト」セクションをそのまま次のチャットに貼り付けてください。添付ファイルとして①このドキュメント ②Excelデータベース ③写真フォルダ（ZIP）を一緒にアップロードすると最も効果的です。

---

## 1. プロダクト概要

### 1.1 FlashInputとは
英単語の**インプット（記憶定着）専用ツール**。ゲームやテストの**前段階**として、科学的な記憶エンコーディング手法で単語を脳に刻み込む。

### 1.2 ポジショニング
```
[FlashInput: インプット] → [ゲーム: アウトプット/反復練習]
  ↑ 今回のスコープ              将来のスコープ
```

### 1.3 コンセプト
- **ゲームではなくインプット装置** — 脳に焼き付ける「前段階」
- **完全自動進行** — ハンズフリーで脳に浸透させる
- **リアル写真ベース** — Canvaで用意したスタイリッシュな実写写真
- **ダークシネマティック** — 子供向けだが「大人っぽくてかっこいい」デザイン

### 1.4 対象ユーザー
- 小学校高学年〜高校生（英検5級〜2級レベル）
- 親がセットアップし、子供が1人で使う想定

---

## 2. 認知科学的根拠

FlashInputの5フェーズフローは以下の理論に基づく：

| フェーズ | 認知科学理論 | 効果 |
|---------|------------|------|
| IMAGE | Dual Coding Theory（二重符号化） | 視覚＋言語の二重エンコーディング |
| WORD | Production Effect（生成効果） | 音声で発話することで記憶強化 |
| MEANING | Elaborative Encoding（精緻化符号化） | 画像と単語の統合で深い処理 |
| CONTEXT | Episodic Memory（エピソード記憶） | 文脈の中で体験的に記憶 |
| RECALL | Retrieval Practice（検索練習効果） | 想起すること自体が記憶を強化 |

---

## 3. 画面フロー

### 3.1 全体フロー
```
[レベル選択] → [ユニット選択] → [スタート画面] → [Round 1: 5フェーズ学習]
                                                       ↓
                               [完了画面] ← [Round 2: スピードレビュー]
```

### 3.2 レベル選択画面
- 英検5級〜2級の5レベルを表示
- 各レベルのユニット数・進捗を表示
- レベルごとにアクセントカラーを変える

### 3.3 ユニット選択画面
- 選択されたレベルのユニット一覧
- 1ユニット = 6〜8単語
- 進捗状態（未学習 / 学習済み / 復習推奨）

### 3.4 スタート画面
- ユニット内の写真サムネイル一覧
- スピード設定（×0.8 / ×1.0 / ×1.5）
- 「START ▶」ボタン
- ダーク背景、背景に最初の写真をぼかして表示

### 3.5 プレイ画面（5フェーズ × N単語 × 2ラウンド）

#### Round 1: Full Input
各単語について5フェーズが自動で進行する：

**Phase 1: IMAGE（約2.8秒）**
- 写真だけをバーンと表示
- 「WHAT IS THIS IN ENGLISH?」の小さなテキスト
- 背景に写真が大きく広がる

**Phase 2: WORD（約3.2秒）**
- 英単語を大きく表示（clamp(48px, 14vw, 88px)）
- 発音記号を `#00d4aa` で表示
- 日本語訳を表示
- Web Speech APIで自動読み上げ
- 背景は写真をぼかして暗く

**Phase 3: MEANING（約2.8秒）**
- 写真の上に英単語をオーバーレイ
- 「IMAGE + WORD = MEMORY」のガイドテキスト
- 視覚と言語の統合を促す

**Phase 4: CONTEXT（約3.5秒）**
- 例文を表示、単語部分だけ `#00d4aa` でハイライト
- 例文全体を音声で自動読み上げ
- 「LISTEN & REPEAT」のガイドテキスト

**Phase 5: RECALL（約4.5秒）**
- 前半：写真をぼかし＋「????」表示＋日本語のみ
- 後半（55%経過時）：答えを `#00d4aa` で表示＋音声読み上げ
- 「✓ SAY IT ALOUD」のガイドテキスト

#### Round 2: Speed Review
Round 1完了後、同じ単語を高速で再巡回（フェーズ時間を短縮）

### 3.6 完了画面
- 「✦ Complete」タイトル
- 学習した単語の写真グリッド（3列）
- 各写真の上に英単語をオーバーレイ
- 「↻ RESTART」ボタン

---

## 4. UI/UXデザイン仕様

### 4.1 デザイントーン
**ダークシネマティック** — 黒基調に写真映えするミニマルデザイン

### 4.2 カラーシステム
```
背景:        #0a0a0a（メイン背景）
アクセント:   #00d4aa（ティール系グリーン）
テキスト白:   #ffffff
テキスト薄:   #777777, #555555, #444444
プログレス:   #00d4aa（完了）/ #333333（未完了）/ #1a1a1a（未到達）
```

### 4.3 タイポグラフィ
```
見出し/UI:   Inter (weight: 300-900)
等幅/ラベル:  Space Mono (monospace)
```
Google Fonts CDN:
```
https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Space+Mono:wght@400;700&display=swap
```

### 4.4 レイアウト
- フルスクリーン（min-height: 100vh）
- 最大幅制限なし（写真が画面いっぱいに広がる）
- コンテンツは中央寄せ
- モバイルファースト（clamp()でレスポンシブ）

### 4.5 写真の扱い
- 背景：写真をフルスクリーンで表示、フェーズに応じてopacity/blur/brightnessを変動
  - IMAGE: opacity 0.55, blur なし
  - WORD/MEANING/CONTEXT: opacity 0.18, blur 6px, brightness 0.6
  - RECALL（未回答）: opacity 0.6, blur 30px, brightness 0.7
- カード内表示：16:10 or 4:3比率、border-radius 16px、box-shadow付き
- 画像プリロード：ユニット開始時に全画像をプリロード

### 4.6 アニメーション
- フェーズ遷移：0.25秒のフェードアウト → 新コンテンツのフェードイン
- 背景遷移：transition all 0.6s ease
- プログレスバー：リアルタイムで滑らかに進行（30msインターバル）
- タップ反応：scale(0.95) → scale(1)

### 4.7 プログレス表示
**上部バー（単語進捗）：**
- 横並びのバー（WORDS.length本）
- 完了 = `#00d4aa`、進行中 = 中にフェーズ進捗、未到達 = `#1a1a1a`

**フェーズインジケーター：**
- IMAGE / WORD / MEANING / CONTEXT / RECALL の5つのラベル
- 現在のフェーズが `#00d4aa` ＋ ボーダー付き

**タイマーバー：**
- 画面最下部に固定（position: fixed, height: 3px）
- `#00d4aa` で左から右へ進行

---

## 5. データ構造

### 5.1 語彙データベース（Excel）
添付のExcelファイル `flashinput_vocabulary_db.xlsx` に以下の構造：

**シート1: レベル設計マスター**

| 級 | 累計語彙 | 新出語 | FlashInput対象 | ユニット数 | 1ユニットあたり | 対象学年 |
|----|---------|-------|--------------|----------|--------------|---------|
| 5級 | 600 | 600 | 300 | 50 | 6語 | 中1 |
| 4級 | 1,300 | 700 | 350 | 58 | 6語 | 中2 |
| 3級 | 2,100 | 800 | 400 | 67 | 6語 | 中3 |
| 準2級 | 3,600 | 1,500 | 500 | 63 | 8語 | 高1-2 |
| 2級 | 5,100 | 1,500 | 500 | 63 | 8語 | 高3 |
| **合計** | | | **2,050** | **301** | | |

**シート2: カテゴリマスター（21カテゴリ）**

| ID | カテゴリ（日本語） | カテゴリ（英語） | アイコン | 対象級 |
|----|----------------|----------------|---------|-------|
| CAT01 | 家・家族 | Home & Family | 🏠 | 5-2級 |
| CAT02 | 食べ物・飲み物 | Food & Drinks | 🍎 | 5-2級 |
| CAT03 | 学校 | School | 🏫 | 5-2級 |
| CAT04 | 動物 | Animals | 🐾 | 5-2級 |
| CAT05 | 動作・スポーツ | Actions & Sports | 🏃 | 5-2級 |
| CAT06 | 天気・自然 | Weather & Nature | 🌤️ | 5-2級 |
| CAT07 | 服・もの | Clothes & Things | 👕 | 5-2級 |
| CAT08 | 場所 | Places | 🏙️ | 5-2級 |
| CAT09 | 時間 | Time | ⏰ | 5-2級 |
| CAT10 | 気持ち | Feelings | 😊 | 5-2級 |
| CAT11 | 趣味 | Hobbies | 🎵 | 5-2級 |
| CAT12 | 乗り物 | Transportation | 🚗 | 5-2級 |
| CAT13 | 仕事 | Jobs | 💼 | 3-2級 |
| CAT14 | 国・旅行 | Countries & Travel | 🌍 | 3-2級 |
| CAT15 | 健康・体 | Health & Body | 🏥 | 3-2級 |
| CAT16 | テクノロジー | Technology | 📱 | 3-2級 |
| CAT17 | 科学・環境 | Science & Environment | 🔬 | 準2-2級 |
| CAT18 | 社会・ニュース | Society & News | 📰 | 準2-2級 |
| CAT19 | 経済・ビジネス | Economy & Business | 💰 | 準2-2級 |
| CAT20 | 教育 | Education | 🎓 | 準2-2級 |
| CAT21 | 心理 | Psychology | 🧠 | 2級 |

**シート3-7: 各級の単語リスト（各30語のサンプル入り）**
カラム構成：
```
No | 英単語 | 日本語 | 品詞 | カテゴリID | カテゴリ名 | 発音記号 | 例文 | 写真ファイル名 | ユニット番号 | 写真URL/メモ
```

**シート8: 写真フォルダ構成**

### 5.2 単語データオブジェクト（JSX内の構造）
```javascript
{
  word: "mountain",        // 英単語
  japanese: "山",          // 日本語訳
  phonetic: "máuntn",     // 発音記号
  img: "./photos/...",     // 写真パス（またはURL）
  sentence: "The mountain touches the sky.", // 例文（単語を含む）
  category: "CAT06",       // カテゴリID
  unit: 1,                // ユニット番号
}
```

### 5.3 写真フォルダ構成
```
FlashInput_Photos/
├── Eiken5/
│   ├── home_family/       (~25枚)
│   ├── food_drinks/       (~30枚)
│   ├── school/            (~25枚)
│   ├── animals/           (~25枚)
│   ├── actions_sports/    (~30枚)
│   ├── weather_nature/    (~25枚)
│   ├── clothes_things/    (~20枚)
│   ├── places/            (~20枚)
│   ├── time/              (~15枚)
│   ├── feelings/          (~15枚)
│   ├── hobbies/           (~20枚)
│   └── transportation/    (~15枚)
├── Eiken4/                (~350枚)
├── Eiken3/                (~400枚、+jobs/travel/health/tech)
├── EikenPre2/             (~500枚、+science/society/economy/education/psychology)
└── Eiken2/                (~500枚)
```
ファイル命名規則: `{word}_01.jpg`（例: mountain_01.jpg）

### 5.4 写真の選定基準
- **具象名詞・動詞を優先** — 写真で表現できるもの
- **抽象語・機能語は対象外** — 前置詞、接続詞、冠詞はゲームフェーズで扱う
- カテゴリごとにCanvaで統一感のある写真を用意

---

## 6. 機能仕様

### 6.1 自動進行システム
- 各フェーズにベース時間を設定（上記参照）
- スピード倍率（×0.8/×1.0/×1.5）で全フェーズ時間を除算
- フェーズ終了時に自動で次へ遷移（250msのトランジション挟む）
- 全単語×5フェーズ完了 → Round 2へ自動移行
- Round 2完了 → 完了画面

### 6.2 一時停止/再開
- 画面タップでトグル
- 一時停止中はオーバーレイ表示（「PAUSED」＋ ▶ アイコン）
- 「Tap anywhere to resume」のガイドテキスト

### 6.3 音声読み上げ
- Web Speech API（SpeechSynthesisUtterance）
- 英語音声（lang: "en-US"）
- WORDフェーズ：単語を読み上げ（rate: 0.85）
- CONTEXTフェーズ：例文全体を読み上げ
- RECALLフェーズ：答え表示時に単語を読み上げ

### 6.4 画像プリロード
- ユニット開始時に全画像を `new Image()` でプリロード
- 遅延読み込みによるちらつきを防止

### 6.5 2ラウンド制
- **Round 1**: 通常速度で5フェーズ完全学習
- **Round 2**: 同じ単語をスピードレビュー（同フェーズだが体感は速い）
- ラウンド表示：上部バーに「ROUND 1」/「ROUND 2 — SPEED」

---

## 7. 技術スタック

### 7.1 フレームワーク
- **React（JSX）** — Claude Artifactsで動作する単一ファイル
- Hooks: useState, useEffect, useCallback, useRef
- 外部ライブラリ不要（Tailwindも使わず、全てインラインスタイル）

### 7.2 利用可能なAPI
- Web Speech API（音声読み上げ）
- Google Fonts CDN（Inter, Space Mono）

### 7.3 画像の読み込み
写真は以下のいずれかで参照：
- **方法A**: Unsplash等の外部URL（プロトタイプ用）
- **方法B**: ローカルパス（本番用、写真フォルダを同梱）
- **方法C**: Base64エンコード（単一ファイルに全て含める）

---

## 8. プロトタイプからの変更点（実装時の注意）

### 8.1 現在のプロトタイプ（flashinput.jsx）の状態
- ✅ 5フェーズ自動進行フロー
- ✅ ダークシネマティックデザイン
- ✅ スピード制御（×0.8/×1.0/×1.5）
- ✅ タップで一時停止/再開
- ✅ 2ラウンド制
- ✅ Web Speech API音声読み上げ
- ✅ プログレスバー/フェーズインジケーター

### 8.2 実装で追加が必要な機能
- ❌ レベル選択画面（5級〜2級）
- ❌ ユニット選択画面
- ❌ Excelデータベースからの単語データ読み込み
- ❌ 実写真（Canvaで用意した画像）への差し替え
- ❌ 進捗管理（localStorage等）
- ❌ ユニット完了後の次ユニットへの遷移

---

## 9. 補足：競合との差別化

| 項目 | mochitan（競合） | FlashInput（本アプリ） |
|------|-----------------|---------------------|
| 目的 | ゲーム＋暗記 | インプット特化（ゲームの前段階） |
| 視覚 | イラスト/アイコン | 実写真（Canva） |
| 操作 | タップ/スワイプ操作 | 完全自動進行（ハンズフリー） |
| 記憶法 | 忘却曲線ベースの反復 | 5フェーズ科学的エンコーディング |
| デザイン | カラフル/ゲーム的 | ダークシネマティック/大人っぽい |
| 語彙基盤 | 英検/TOEIC/英会話 | 英検5級〜2級（Eiken準拠） |

---

---

# 実装プロンプト（次のチャットにコピペ用）

以下をそのまま次のチャットの最初のメッセージとして貼り付けてください：

---

```
FlashInputという英単語インプットアプリのReact実装を依頼します。

## 添付ファイル
1. 要件定義書（このMDファイル）— 全仕様が記載されています
2. flashinput_vocabulary_db.xlsx — 語彙データベース（5級〜2級、21カテゴリ、サンプル150語）
3. 写真フォルダ — 各単語に対応する実写真
4. flashinput.jsx — 現在のプロトタイプ（動作確認済み）

## やってほしいこと
添付のプロトタイプ（flashinput.jsx）をベースに、以下を実装してください：

### 1. レベル＆ユニット選択画面の追加
- 英検5級〜2級のレベル選択画面
- 各レベル内のユニット選択画面
- ユニットは6〜8語ずつ（Excel準拠）

### 2. Excelデータベースとの連携
- 添付のExcelからWord配列を生成
- 各単語オブジェクトの構造:
  { word, japanese, phonetic, img, sentence, category, unit }

### 3. 実写真への差し替え
- 添付の写真フォルダのファイルを参照
- 写真ファイル名は `{word}_01.jpg` の命名規則
- 画像プリロードは既存実装を維持

### 4. 既存の5フェーズフローは維持
プロトタイプで実装済みの以下はそのまま維持：
- IMAGE → WORD → MEANING → CONTEXT → RECALL の自動進行
- スピード制御（×0.8 / ×1.0 / ×1.5）
- タップで一時停止/再開
- 2ラウンド制（Round 1 + Round 2 Speed Review）
- ダークシネマティックデザイン（#0a0a0a背景、#00d4aaアクセント）
- Web Speech API音声読み上げ
- プログレスバー / フェーズインジケーター

### 5. デザイン要件
- ダーク背景(#0a0a0a)にティールアクセント(#00d4aa)
- フォント: Inter + Space Mono（Google Fonts）
- モバイルファースト、clamp()でレスポンシブ
- 写真は背景にフルスクリーン表示（フェーズごとにblur/opacity変動）
- シネマティックで大人っぽい雰囲気（子供向けだがカッコいい）

### 制約
- React単一ファイル（.jsx）で実装
- 外部ライブラリ不使用（Tailwind不使用、インラインスタイル）
- Claude Artifactsで動作すること
```

---

## Appendix: プロトタイプのコード構造参考

現在のプロトタイプ `flashinput.jsx` の主要構造：

```
FlashcardApp (default export)
├── State: screen, wordIdx, phaseIdx, paused, reveal, progress, round, speed
├── Refs: timerRef, progressRef, startTimeRef, remainingRef
├── usePreloadImages() — 画像プリロード
├── advance() — フェーズ/単語/ラウンド進行ロジック
├── togglePause() — 一時停止/再開
├── handleStart() — 学習開始
│
├── Screen: "start" — スタート画面
│   ├── 写真サムネイル一覧
│   ├── スピード設定ボタン
│   └── START ▶ ボタン
│
├── Screen: "play" — プレイ画面
│   ├── 背景画像（フェーズごとにblur/opacity変動）
│   ├── TOP BAR（ラウンド表示 + 進捗カウンター）
│   ├── WORD PROGRESS DOTS（単語ごとの進捗バー）
│   ├── PHASE INDICATOR（IMAGE/WORD/MEANING/CONTEXT/RECALL）
│   ├── MAIN CONTENT（フェーズごとに切り替え）
│   │   ├── Phase: photo — 写真表示 + "WHAT IS THIS?"
│   │   ├── Phase: word — 英単語 + 発音記号 + 日本語 + 音声
│   │   ├── Phase: meaning — 写真+単語オーバーレイ
│   │   ├── Phase: sentence — 例文（単語ハイライト）+ 音声
│   │   └── Phase: recall — ???? → 答え表示 + 音声
│   ├── TIMER BAR（画面最下部、リアルタイム進行）
│   └── PAUSE OVERLAY
│
└── Screen: "done" — 完了画面
    ├── 写真グリッド（3列）
    └── RESTART ボタン
```
